{
  "comments": [
    {
      "key": {
        "uuid": "5ac665da_6268a6bb",
        "filename": "packages/SettingsProvider/src/com/android/providers/settings/DatabaseHelper.java",
        "patchSetId": 3
      },
      "lineNbr": 2817,
      "author": {
        "id": 3134
      },
      "writtenOn": "2015-03-27T00:41:17Z",
      "side": 1,
      "message": "IMHO, this logic could be simplified with:\n\n final String[] defNetworkSettings \u003d SystemProperties.get(\"ro.telephony.default_network\", \"\").split(\",\");\n final int defaultNetworkSettingsLength \u003d defaultNetworkSettings.length;\n final int phoneCount \u003d TelephonyManager.getDefault().getPhoneCount();\n final String[] networkSettings \u003d new String[phoneCount];\n boolean error \u003d defNetworkSettings.length !\u003d phoneCount;\n if (!error) {\n     for (int i \u003d 0; i \u003c phoneCount; i++) {\n         try {\n             networkSettings[i] \u003d String.valueOf(Integer.parseInt(defNetworkSettings[i]));\n         } catch (NumberFormatException ex) {\n             error \u003d true;\n             break;\n         }\n     }\n }\n if (error) {\n     Log.w(TAG, \"Wrong ro.telephony.default_network setting \" + val + \". Fallback to defaults\");\n     Arrays.fill(networkSettings, RILConstants.PREFERRED_NETWORK_MODE);\n }\n loadSetting(stmt, Settings.Global.PREFERRED_NETWORK_MODE, TextUtils.join(networkSettings, \",\"));",
      "revId": "28eb62d0153e9af1e21501698877a35c5d88cb9a",
      "serverId": "1ec6b3db-b2c1-4fa4-84a2-4c7efe89ba71",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5ac665da_c7352cf8",
        "filename": "packages/SettingsProvider/src/com/android/providers/settings/DatabaseHelper.java",
        "patchSetId": 3
      },
      "lineNbr": 2821,
      "author": {
        "id": 883
      },
      "writtenOn": "2015-03-26T19:58:34Z",
      "side": 1,
      "message": "move boolean error \u003d false; to here",
      "revId": "28eb62d0153e9af1e21501698877a35c5d88cb9a",
      "serverId": "1ec6b3db-b2c1-4fa4-84a2-4c7efe89ba71",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5ac665da_4265aadf",
        "filename": "packages/SettingsProvider/src/com/android/providers/settings/DatabaseHelper.java",
        "patchSetId": 3
      },
      "lineNbr": 2821,
      "author": {
        "id": 3134
      },
      "writtenOn": "2015-03-27T00:41:17Z",
      "side": 1,
      "message": "error is only used in the block below, so there is not need to move here",
      "parentUuid": "5ac665da_c7352cf8",
      "revId": "28eb62d0153e9af1e21501698877a35c5d88cb9a",
      "serverId": "1ec6b3db-b2c1-4fa4-84a2-4c7efe89ba71",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5ac665da_e730280a",
        "filename": "packages/SettingsProvider/src/com/android/providers/settings/DatabaseHelper.java",
        "patchSetId": 3
      },
      "lineNbr": 2823,
      "author": {
        "id": 883
      },
      "writtenOn": "2015-03-26T19:58:34Z",
      "side": 1,
      "message": "error \u003d true;",
      "revId": "28eb62d0153e9af1e21501698877a35c5d88cb9a",
      "serverId": "1ec6b3db-b2c1-4fa4-84a2-4c7efe89ba71",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5ac665da_672558c1",
        "filename": "packages/SettingsProvider/src/com/android/providers/settings/DatabaseHelper.java",
        "patchSetId": 3
      },
      "lineNbr": 2827,
      "author": {
        "id": 883
      },
      "writtenOn": "2015-03-26T19:58:34Z",
      "side": 1,
      "message": "fixme!",
      "revId": "28eb62d0153e9af1e21501698877a35c5d88cb9a",
      "serverId": "1ec6b3db-b2c1-4fa4-84a2-4c7efe89ba71",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5ac665da_a2629ed6",
        "filename": "packages/SettingsProvider/src/com/android/providers/settings/DatabaseHelper.java",
        "patchSetId": 3
      },
      "lineNbr": 2827,
      "author": {
        "id": 3134
      },
      "writtenOn": "2015-03-27T00:41:17Z",
      "side": 1,
      "message": "As Shareef said, we need to fallback to defaults in error",
      "parentUuid": "5ac665da_672558c1",
      "revId": "28eb62d0153e9af1e21501698877a35c5d88cb9a",
      "serverId": "1ec6b3db-b2c1-4fa4-84a2-4c7efe89ba71",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5ac665da_47093c31",
        "filename": "packages/SettingsProvider/src/com/android/providers/settings/DatabaseHelper.java",
        "patchSetId": 3
      },
      "lineNbr": 2842,
      "author": {
        "id": 883
      },
      "writtenOn": "2015-03-26T19:58:34Z",
      "side": 1,
      "message": "if (error || (TextUtils.isEmpty(val) \u0026\u0026 phoneCount !\u003d 0)) {\n    val \u003d \"\";\n    for (int i \u003d 0; i \u003c phoneCount; i++){\n         val +\u003d RILConstants.PREFERRED_NETWORK_MODE + \"\";\n         if (i \u003c phoneCount - 1)\n             val +\u003d \",\";\n    }\n    loadSetting(stmt, Settings.Global.PREFERRED_NETWORK_MODE, val);\n}",
      "revId": "28eb62d0153e9af1e21501698877a35c5d88cb9a",
      "serverId": "1ec6b3db-b2c1-4fa4-84a2-4c7efe89ba71",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5ac665da_825fa20d",
        "filename": "packages/SettingsProvider/src/com/android/providers/settings/DatabaseHelper.java",
        "patchSetId": 3
      },
      "lineNbr": 2842,
      "author": {
        "id": 3134
      },
      "writtenOn": "2015-03-27T00:41:17Z",
      "side": 1,
      "message": "IMHO, we are looping too much times over the same loop conditions. TextUtils have a join method for this.",
      "parentUuid": "5ac665da_47093c31",
      "revId": "28eb62d0153e9af1e21501698877a35c5d88cb9a",
      "serverId": "1ec6b3db-b2c1-4fa4-84a2-4c7efe89ba71",
      "unresolved": false
    }
  ]
}